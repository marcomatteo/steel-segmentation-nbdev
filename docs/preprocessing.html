---

title: Preprocessing


keywords: fastai
sidebar: home_sidebar

summary: "Make png mask for DL models."
description: "Make png mask for DL models."
nb_path: "nbs/02_preprocessing.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/02_preprocessing.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/mmb/miniconda3/envs/env_nbdev/lib/python3.8/site-packages/torch/cuda/__init__.py:52: UserWarning: CUDA initialization: Found no NVIDIA driver on your system. Please check that you have an NVIDIA GPU and installed a driver from http://www.nvidia.com/Download/index.aspx (Triggered internally at  /opt/conda/conda-bld/pytorch_1607370172916/work/c10/cuda/CUDAFunctions.cpp:100.)
  return torch._C._cuda_getDeviceCount() &gt; 0
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For FastAI Segmentation DataLoader we need to build :</p>
<ol>
<li><p>the codes: the type of pixels in the images</p>
</li>
<li><p>the labels: the masks for each image</p>
</li>
<li><p>Cropping the images</p>
</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Codes-(opt.)">Codes (opt.)<a class="anchor-link" href="#Codes-(opt.)"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Codes are the labels for the corrisponding pixel values in the mask images.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">codes_file_name</span> <span class="o">=</span> <span class="s2">&quot;codes.txt&quot;</span>
<span class="n">codes_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="n">codes_file_name</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">codes_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
    <span class="n">classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">ClassId</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">classes</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;codes.txt&#39;</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%u</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">codes_path</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

<span class="n">classes</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0, 1, 2, 3, 4], dtype=uint8)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Labels">Labels<a class="anchor-link" href="#Labels"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Labels are the masks for the training images.</p>
<p>As a first approach, i tried to create masks only for the images that present a defect. But this will exclude all the good images that can be used to teach to the model to recognize good steel pixels.</p>
<p>Now I created the masks for all the images in the training folder.</p>
<p><strong>NB: masks must be PNG files and not JPEG because JPEG's compression makes the labels get messed up occasionally</strong> (<a href="https://forums.fast.ai/t/unet-learner-failing-with-a-cuda-device-assert/66747/4">source</a>).</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_masks" class="doc_header"><code>create_masks</code><a href="https://github.com/marcomatteo/steel_segmentation/tree/master/steel_segmentation/preprocessing.py#L20" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_masks</code>(<strong><code>df</code></strong>:<code>DataFrame</code>)</p>
</blockquote>
<p>Create the mask files under the <a href="/steel_segmentation/preprocessing.html#labels_dir"><code>labels_dir</code></a></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="ow">not</span> <span class="n">labels_dir</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
    <span class="n">labels_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">create_masks</span><span class="p">(</span><span class="n">train_all</span><span class="p">)</span>

<span class="n">labels_dir</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#6667) [Path(&#39;../data/labels/0002cc93b_P.png&#39;),Path(&#39;../data/labels/0007a71bf_P.png&#39;),Path(&#39;../data/labels/000a4bcdd_P.png&#39;),Path(&#39;../data/labels/000f6bf48_P.png&#39;),Path(&#39;../data/labels/0014fce06_P.png&#39;),Path(&#39;../data/labels/0025bde0c_P.png&#39;),Path(&#39;../data/labels/002af848d_P.png&#39;),Path(&#39;../data/labels/002fc4e19_P.png&#39;),Path(&#39;../data/labels/0030401a5_P.png&#39;),Path(&#39;../data/labels/0046839bd_P.png&#39;)...]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With the PNG extension, the multi-label segmentation problem would seem desappear.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">mask_paths</span><span class="p">[</span><span class="mi">100</span><span class="p">])));</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Cropping">Cropping<a class="anchor-link" href="#Cropping"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The standard size of the images is <code>(256, 1600)</code> and maybe it's because of this that I always go out of memory in the GPU.</p>

</div>
</div>
</div>
</div>
 

