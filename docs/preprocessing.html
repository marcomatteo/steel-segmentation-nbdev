---

title: Preprocessing


keywords: fastai
sidebar: home_sidebar

summary: "Make png mask for DL models."
description: "Make png mask for DL models."
nb_path: "02_preprocessing.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 02_preprocessing.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/opt/conda/envs/fastai/lib/python3.8/site-packages/torch/cuda/__init__.py:52: UserWarning: CUDA initialization: Found no NVIDIA driver on your system. Please check that you have an NVIDIA GPU and installed a driver from http://www.nvidia.com/Download/index.aspx (Triggered internally at  /pytorch/c10/cuda/CUDAFunctions.cpp:100.)
  return torch._C._cuda_getDeviceCount() &gt; 0
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For FastAI Segmentation DataLoader we need to build :</p>
<ol>
<li><p>the codes: the type of pixels in the images</p>
</li>
<li><p>the labels: the masks for each image</p>
</li>
<li><p>Cropping the images</p>
</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Codes-(opt.)">Codes (opt.)<a class="anchor-link" href="#Codes-(opt.)"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Codes are the labels for the corrisponding pixel values in the mask images.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">codes_file_name</span> <span class="o">=</span> <span class="s2">&quot;codes.txt&quot;</span>
<span class="n">codes_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="n">codes_file_name</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">codes_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
    <span class="n">classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">ClassId</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">classes</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;codes.txt&#39;</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%u</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">codes_path</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

<span class="n">classes</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0, 1, 2, 3, 4], dtype=uint8)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Labels">Labels<a class="anchor-link" href="#Labels"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Labels are the masks for the training images.</p>
<p>As a first approach, i tried to create masks only for the images that present a defect. But this will exclude all the good images that can be used to teach to the model to recognize good steel pixels.</p>
<p>Now I created the masks for all the images in the training folder.</p>
<p><strong>NB: masks must be PNG files and not JPEG because JPEG's compression makes the labels get messed up occasionally</strong> (<a href="#https://forums.fast.ai/t/unet-learner-failing-with-a-cuda-device-assert/66747/4">source</a>)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_masks" class="doc_header"><code>create_masks</code><a href="https://github.com/marcomatteo/steel_segmentation/tree/master/steel_segmentation/preprocessing.py#L20" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_masks</code>(<strong><code>df</code></strong>:<code>DataFrame</code>)</p>
</blockquote>
<p>Create the mask files under the <a href="/steel_segmentation/preprocessing.html#labels_dir"><code>labels_dir</code></a></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="ow">not</span> <span class="n">labels_dir</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
    <span class="n">labels_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">create_masks</span><span class="p">(</span><span class="n">train_all</span><span class="p">)</span>

<span class="n">labels_dir</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#12568) [Path(&#39;data/labels/54fd0b997_P.png&#39;),Path(&#39;data/labels/5f5a2e357_P.png&#39;),Path(&#39;data/labels/3ab4ca44c_P.png&#39;),Path(&#39;data/labels/5b202c6f5_P.png&#39;),Path(&#39;data/labels/026183d85_P.png&#39;),Path(&#39;data/labels/5acf0f8cd_P.png&#39;),Path(&#39;data/labels/79b696401_P.png&#39;),Path(&#39;data/labels/65d8eae69_P.png&#39;),Path(&#39;data/labels/637a0124c_P.png&#39;),Path(&#39;data/labels/f95e24d0a_P.png&#39;)...]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With the PNG extension, the multi-label segmentation problem would seem desappear.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mask_paths</span> <span class="o">=</span> <span class="n">get_image_files</span><span class="p">(</span><span class="n">labels_dir</span><span class="p">)</span>
<span class="n">dotest</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">dotest</span><span class="p">:</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mask_paths</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">get_random_idx</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">pixels</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">mask_paths</span><span class="p">[</span><span class="n">idx</span><span class="p">]:</span>
        <span class="n">pixels_founded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">p</span><span class="p">)))</span>
        <span class="n">pixels</span> <span class="o">=</span> <span class="n">pixels</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">pixels_founded</span><span class="p">))</span>
    <span class="n">pixels</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mask_paths</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#12568) [Path(&#39;data/labels/54fd0b997_P.png&#39;),Path(&#39;data/labels/5f5a2e357_P.png&#39;),Path(&#39;data/labels/3ab4ca44c_P.png&#39;),Path(&#39;data/labels/5b202c6f5_P.png&#39;),Path(&#39;data/labels/026183d85_P.png&#39;),Path(&#39;data/labels/5acf0f8cd_P.png&#39;),Path(&#39;data/labels/79b696401_P.png&#39;),Path(&#39;data/labels/65d8eae69_P.png&#39;),Path(&#39;data/labels/637a0124c_P.png&#39;),Path(&#39;data/labels/f95e24d0a_P.png&#39;)...]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">mask_paths</span><span class="p">[</span><span class="mi">100</span><span class="p">])));</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Cropping">Cropping<a class="anchor-link" href="#Cropping"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The standard size of the images is <code>(256, 1600)</code> and maybe it's because of this that I always go out of memory in the GPU.</p>

</div>
</div>
</div>
</div>
 

