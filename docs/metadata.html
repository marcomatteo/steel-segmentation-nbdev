---

title: Metadata


keywords: fastai
sidebar: home_sidebar

summary: "Exploratory Analysis on training set informations."
description: "Exploratory Analysis on training set informations."
nb_path: "nbs/01_metadata.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/01_metadata.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-structure">Data structure<a class="anchor-link" href="#Data-structure"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">curr_dir_name</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span><span class="o">.</span><span class="n">name</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;../data/&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">curr_dir_name</span> <span class="o">==</span> <span class="s1">&#39;nbs&#39;</span> <span class="k">else</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;data/&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
    <span class="n">path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <a href="/steel_segmentation/metadata.html#path"><code>path</code></a> variable is a <code>os.pathlib.Path</code> object that points to the competition data.</p>
<p>To print all the files this directory use the <a href="/steel_segmentation/metadata.html#print_competition_data"><code>print_competition_data</code></a> function.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="print_competition_data" class="doc_header"><code>print_competition_data</code><a href="https://github.com/marcomatteo/steel_segmentation/tree/master/steel_segmentation/metadata.py#L23" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>print_competition_data</code>(<strong><code>p</code></strong>:<code>Path</code>=<em><code>Path('data')</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_competition_data</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>../data/test_images
../data/hard_negatives_patterns.txt
../data/labels
../data/codes.txt
../data/submissions
../data/train.csv
../data/severstal-steel-defect-detection.zip
../data/train_images
../data/predictions
../data/sample_submission.csv
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The competition files in detail:</p>
<ul>
<li><strong>train_images/</strong> - folder of training images (12.5k images)</li>
<li><strong>test_images/</strong> - folder of test images to segment and classify (5506 images)</li>
<li><strong>train.csv</strong> - training annotations which provide segments for defects (<code>ClassId = [1, 2, 3, 4]</code>)</li>
<li><strong>sample_submission.csv</strong> - a sample submission file in the correct format; note, each <code>ImageId</code> 4 rows, one for each of the 4 defect classes</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_path</span> <span class="o">=</span> <span class="n">path</span><span class="o">/</span><span class="s2">&quot;train_images&quot;</span>
<span class="n">test_path</span> <span class="o">=</span> <span class="n">path</span><span class="o">/</span><span class="s2">&quot;test_images&quot;</span>
<span class="n">train_pfiles</span> <span class="o">=</span> <span class="n">get_image_files</span><span class="p">(</span><span class="n">train_path</span><span class="p">)</span>
<span class="n">test_pfiles</span> <span class="o">=</span> <span class="n">get_image_files</span><span class="p">(</span><span class="n">test_path</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Training-data">Training data<a class="anchor-link" href="#Training-data"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The training data includes:</p>
<ul>
<li><p>faulty images: images that have at least one defect</p>
</li>
<li><p>hard negative images: images with no defects</p>
</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_pfiles</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#12568) [Path(&#39;../data/train_images/58ee62fd7.jpg&#39;),Path(&#39;../data/train_images/eeffa4c49.jpg&#39;),Path(&#39;../data/train_images/0dced41aa.jpg&#39;),Path(&#39;../data/train_images/bd2366c49.jpg&#39;),Path(&#39;../data/train_images/e2bdd4236.jpg&#39;),Path(&#39;../data/train_images/5210ac609.jpg&#39;),Path(&#39;../data/train_images/18076ccc9.jpg&#39;),Path(&#39;../data/train_images/b3f6a891f.jpg&#39;),Path(&#39;../data/train_images/55901ac51.jpg&#39;),Path(&#39;../data/train_images/48831ab9e.jpg&#39;)...]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_train_df" class="doc_header"><code>get_train_df</code><a href="https://github.com/marcomatteo/steel_segmentation/tree/master/steel_segmentation/metadata.py#L34" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_train_df</code>(<strong><code>only_faulty</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Get training DataFrame with all the images in data/train_images.
Returns only the faulty images if <code>only_faulty</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <a href="/steel_segmentation/metadata.html#get_train_df"><code>get_train_df</code></a> function returns the DataFrame from the <a href="/steel_segmentation/metadata.html#train.csv"><code>train.csv</code></a> file, only faulty image names if <code>only_faulty</code>, with the training images metadata:</p>
<ul>
<li><p><strong>ImageId</strong>: image name</p>
</li>
<li><p><strong>ClassId</strong>: the class type</p>
</li>
<li><p><strong>EncodedPixels</strong>: the encoded pixels follows a run-length encoding rule, a sequence of pair values that contains a start position and a run length with the space as the delimiter. E.g. <code>1 3 10 5</code> means pixels <code>(1,2,3)</code> and <code>(10,11,12,13,14)</code>.</p>
</li>
</ul>
<p>Each Image may have no defects, a single defect, or multiple defects.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Hard-negatives-with-patterns">Hard negatives with patterns<a class="anchor-link" href="#Hard-negatives-with-patterns"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hard_neg_patterns</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ImageId</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>000789191.jpg</td>
    </tr>
    <tr>
      <th>1</th>
      <td>00d7ae946.jpg</td>
    </tr>
    <tr>
      <th>2</th>
      <td>01b237ab8.jpg</td>
    </tr>
    <tr>
      <th>3</th>
      <td>01d590c5f.jpg</td>
    </tr>
    <tr>
      <th>4</th>
      <td>01e501f99.jpg</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In <code>pattern_img_list</code> there are the <code>ImageId</code>s of training images with some patterns (from this <a href="https://www.kaggle.com/ateplyuk/detector-steels-with-texture/data">kernel</a>).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Faulty-images">Faulty images<a class="anchor-link" href="#Faulty-images"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span> <span class="o">=</span> <span class="n">get_train_df</span><span class="p">(</span><span class="n">only_faulty</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Only the faulty images are listed in <a href="/steel_segmentation/metadata.html#train"><code>train</code></a> with the defected pixels encoded.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(7095, 4)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ImageId</th>
      <th>ClassId</th>
      <th>EncodedPixels</th>
      <th>ImageId_ClassId</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0002cc93b.jpg</td>
      <td>1</td>
      <td>29102 12 29346 24 29602 24 29858 24 30114 24 30370 24 30626 24 30882 24 31139 23 31395 23 31651 23 31907 23 32163 23 32419 23 32675 23 77918 27 78174 55 78429 60 78685 64 78941 68 79197 72 79452 77 79708 81 79964 85 80220 89 80475 94 80731 98 80987 102 81242 105 81498 105 81754 104 82010 104 82265 105 82521 31 82556 69 82779 27 82818 63 83038 22 83080 57 83297 17 83342 50 83555 13 83604 44 83814 8 83866 37 84073 3 84128 31 84390 25 84652 18 84918 8 85239 10 85476 29 85714 47 85960 57 86216 57 86471 58 86727 58 86983 58 87238 59 87494 59 87750 59 88005 60 88261 60 88517 60 88772 61 89028 53...</td>
      <td>0002cc93b.jpg_1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0007a71bf.jpg</td>
      <td>3</td>
      <td>18661 28 18863 82 19091 110 19347 110 19603 110 19859 110 20115 110 20371 110 20627 110 20883 110 21139 110 21395 110 21651 110 21962 55 293125 251 293381 251 293637 251 293893 251 294149 251 294405 251 294661 251 294917 251 295173 251 295429 251 295685 251 295941 251 296197 251 296453 251 296709 251 296965 251 297221 251 297477 251 297733 251 297989 251 298245 251 298564 188 298945 63</td>
      <td>0007a71bf.jpg_3</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Every row of the DataFrame is a unique <code>(ImageId, ClassId)</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="ow">not</span> <span class="n">train</span><span class="o">.</span><span class="n">ImageId_ClassId</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>ImageId            object
ClassId             int64
EncodedPixels      object
ImageId_ClassId    object
dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>ClassId</code> column values from <a href="/steel_segmentation/metadata.html#train"><code>train</code></a> are:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">class_count</span> <span class="o">=</span> <span class="n">count_pct</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
<span class="n">class_count</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>num</th>
      <th>freq</th>
    </tr>
    <tr>
      <th>ClassId</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>897</td>
      <td>0.126427</td>
    </tr>
    <tr>
      <th>2</th>
      <td>247</td>
      <td>0.034813</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5150</td>
      <td>0.725863</td>
    </tr>
    <tr>
      <th>4</th>
      <td>801</td>
      <td>0.112896</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">class_count</span><span class="p">[</span><span class="s2">&quot;num&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Defects by ClassId count&quot;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAX0AAAETCAYAAADah9Z7AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjMuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8vihELAAAACXBIWXMAAAsTAAALEwEAmpwYAAAXV0lEQVR4nO3dfbBdVZ3m8e9jQMRWRCQgJJGgxhfAFiUianePikpsaHF6ZIxOQwZf0kPRJb6MCjqWdnVlGqsddexpdPCNoKN01LGgQbtlsFFRWgg0irwVUSJE3gKCgAgt+Js/9op16nJz7w0m53JZ30/VrrPP2mvtvfY+yXP2WXufc1NVSJL68IjZ7oAkaXwMfUnqiKEvSR0x9CWpI4a+JHXE0Jekjhj62maSHJPkpiR3JXnCLGx/cZJKst3DaVub2f65Sd40G9vW3GLoa1JJ1if5VZI7k9ye5HtJ/kuSGf2bSbI98GHgFVX1mKq69UH2Y1bDdEJfnpbkS0luSfKLJD9M8vYk88aw7Q8k+fy23s7WMtf62xNDX1P5k6p6LLAXcCLwbuDTM2y7O/Ao4LJt1LexSvIU4PvAdcCzqupxwBHAUuCxs9k3aUsY+ppWVf2iqs4AXgusSLIfQJIdknwoybVtGOcTSXZM8jTgqtb89iTfbPWfkeTsJD9PclWS/7hpG63d/0jy03YWfV6SHYFvj6znriQvSPLUJN9q9W5J8vfT7MIbklyf5IYk72jbe2KSu0eHnZIckGRj+5Qy0V8C36uqt1fVDe24XFVVr6+q2ydWTnJ0kivaJ6WfJPnzkWW7JjmzfYL6eZLvbPoEleTdSX7W2l2V5ODJdijJy5Nc2Y7B/wKyuZ1PMi/Je5L8uK33oiSL2rIXJrmwrefCJC8cabc+yctGnv/27H3kE9iK9vrfkuS9bdky4D3Aa9tr9oPN9U2zoKqcnB4wAeuBl01Sfi1wTJv/KHAGsAvD2e4/AH/dli0GCtiuPf89hrPko4HtgOcCtwD7tuV/B5wLLADmAS8Edpi4nlb3i8B7GU5aHgX8wWb2YVPbL7btPwvYuGm/gK9t2pf2/CPA325mXTcCR09xvCbu76HAUxjC+N8BdwPPbcv+GvgEsH2b/rDVe3o7RnuOrPMpbf4DwOfb/K7AHcBrWvu3AfcBb9pM394JXNrWH+DZwBPa63YbcGR7TV7Xnj9hsn8DE/qwaX8/CezY1nkv8MyJdZ0eWpNn+tpS1wO7JAnwZuBtVfXzqroT+O/A8s20OwxYX1Wfrar7qupi4CvAa9pZ7huA46rqZ1V1f1V9r6ru3cy6fs0w5LRnVd1TVedN0+e/rKpfVtWlwGcZwg1gNfBnMJwNt/LPbWYdTwBumGY7v1VVZ1XVj2vwLeAbDOG+qf97AHtV1a+r6js1JOX9DG90+yTZvqrWV9WPJ1n9HwOXV9WXq+rXDG++N07RnTcB/62GTyZVVT+o4RrLocDVVfW59pp8EbgS+JOZ7ifDsf1VVf0A+AFD+OshzNDXlloA/ByYDzwauKgNU9wO/GMrn8xewPM31W31/xPwRIYz10cBkwXcZN7FcMZ6QZLLkrxhmvrXjcz/FNizzZ/OELBPBl4O/KKqLtjMOm5lCOoZSfLKJP/Shm9uZwjqXdvivwHWAd9oQz/HA1TVOuCtDGfJNyc5LcmeD1j50P/f7lN7w7huknqbLGLyY7snw/EY9VOG13imRt9s7gYeswVtNQsMfc1YkucxBMJ5DEMzv2IYntm5TY+rqs39p78O+NZI3Z1ruKvnmLauexiGQyZ6wM/AVtWNVfXmqtoT+HPgpCRPnaLri0bmn8TwaYWqugdYw/DmcySbP8sH+H/Af5hi+W8l2YHhU8yHgN2rameGoaS07d5ZVe+oqicznFW/fdPYfVV9oar+gOFNsoAPTrKJG0b3qX3qWjRJvU2uY/Jje33bzqgnAT9r879keGPf5IlTbGMif773IcrQ17SS7JTkMOA0hnHaS6vqNwzjuR9JslurtyDJIZtZzZnA05IcmWT7Nj0vyTPbuj4DfDjJnu3C4wtaeG4EfgM8eaQ/RyRZ2J7exhAw90+xC+9L8ugk+zJcUxi98Hsq8J+BVwFT3WL4fuCFSf4myRNbP56a5PNJdp5Q95EMwzQbgfuSvBJ4xUj/D2ttwzA2fz9wf5KnJ3lp2+97GN5UJ9uvs4B9k/xphltZ38LUgfwp4K+SLMng99sF7K8xvCavT7JdktcC+zC8VgCXAMvba7WU4RrCTN0ELM4Mb/HV+PiCaCr/kOROhjPF9zLcd3/0yPJ3MwxT/EuSOxjOhp8+2YramP8rGMb8r2cYFvggQzgC/FeGi40XMgwffRB4RFXdDawCvtuGhQ4Cngd8P8ldDBeSj6uqa6bYj2+1fp4DfKiqvjHSr+8yvKlcXFXrN7eCNrb+AoYLmJcl+QXD2fxa4M5J9vUtDJ8ibgNe3/q5yRKGY3UXcD5wUlWd247FiQyffG4EdmO4C2ZiX25huF30RIZhpyXAd6fY/w+3vnyD4U3m08CObVz/MOAdbT3vAg5r6wd4H8MnhNsY7l76whTbmOhL7fHWJBdvQTttYxmGA6V+Zbil9AtV9anZ7ou0rRn66lq7TnE2sKidoUsPaw7vqFtJVjMMs7zVwFcvPNOXpI54pi9JHTH0Jakjs/5ztdPZdddda/HixbPdDUmaUy666KJbquoB35B/yIf+4sWLWbt27Wx3Q5LmlCQTf2IDcHhHkrpi6EtSRwx9SeqIoS9JHTH0Jakjhr4kdcTQl6SOGPqS1JGH/JezpJ4sPv6s2e7CjKw/8dDZ7oIeJM/0Jakjhr4kdWRGoZ9kfZJLk1ySZG0r2yXJ2Umubo+PH6l/QpJ1Sa4a/UPZSQ5o61mX5GPtD0NLksZkS870X1JV+1fV0vb8eOCcqlrC8AenjwdIsg/DH7/eF1gGnJRkXmvzcWAlwx9yXtKWS5LG5HcZ3jkcWN3mVwOvHik/raruraprgHXAgUn2AHaqqvNr+HNdp460kSSNwUxDv4BvJLkoycpWtntV3QDQHndr5QuA60babmhlC9r8xPIHSLIyydokazdu3DjDLkqSpjPTWzZfVFXXJ9kNODvJlVPUnWycvqYof2Bh1cnAyQBLly71j/hK0lYyozP9qrq+Pd4MfBU4ELipDdnQHm9u1TcAi0aaLwSub+ULJymXJI3JtKGf5PeSPHbTPPAK4EfAGcCKVm0FcHqbPwNYnmSHJHszXLC9oA0B3ZnkoHbXzlEjbSRJYzCT4Z3dga+2uyu3A75QVf+Y5EJgTZI3AtcCRwBU1WVJ1gCXA/cBx1bV/W1dxwCnADsCX2+TJGlMpg39qvoJ8OxJym8FDt5Mm1XAqknK1wL7bXk3JUlbg9/IlaSOGPqS1BFDX5I6YuhLUkcMfUnqiKEvSR0x9CWpI4a+JHXE0Jekjhj6ktQRQ1+SOmLoS1JHDH1J6oihL0kdMfQlqSOGviR1xNCXpI4Y+pLUEUNfkjpi6EtSRwx9SeqIoS9JHTH0Jakjhr4kdcTQl6SOGPqS1BFDX5I6YuhLUkcMfUnqiKEvSR0x9CWpIzMO/STzkvxrkjPb812SnJ3k6vb4+JG6JyRZl+SqJIeMlB+Q5NK27GNJsnV3R5I0lS050z8OuGLk+fHAOVW1BDinPSfJPsByYF9gGXBSknmtzceBlcCSNi37nXovSdoiMwr9JAuBQ4FPjRQfDqxu86uBV4+Un1ZV91bVNcA64MAkewA7VdX5VVXAqSNtJEljMNMz/Y8C7wJ+M1K2e1XdANAed2vlC4DrRuptaGUL2vzEcknSmEwb+kkOA26uqotmuM7JxulrivLJtrkyydokazdu3DjDzUqSpjOTM/0XAa9Ksh44DXhpks8DN7UhG9rjza3+BmDRSPuFwPWtfOEk5Q9QVSdX1dKqWjp//vwt2B1J0lSmDf2qOqGqFlbVYoYLtN+sqj8DzgBWtGorgNPb/BnA8iQ7JNmb4YLtBW0I6M4kB7W7do4aaSNJGoPtfoe2JwJrkrwRuBY4AqCqLkuyBrgcuA84tqrub22OAU4BdgS+3iZJ0phsUehX1bnAuW3+VuDgzdRbBayapHwtsN+WdlKStHX4jVxJ6oihL0kdMfQlqSOGviR1xNCXpI4Y+pLUEUNfkjpi6EtSRwx9SeqIoS9JHTH0Jakjhr4kdcTQl6SOGPqS1BFDX5I6YuhLUkcMfUnqiKEvSR0x9CWpI4a+JHXE0Jekjhj6ktQRQ1+SOmLoS1JHDH1J6oihL0kdMfQlqSOGviR1xNCXpI4Y+pLUEUNfkjoybegneVSSC5L8IMllSf6yle+S5OwkV7fHx4+0OSHJuiRXJTlkpPyAJJe2ZR9Lkm2zW5KkyczkTP9e4KVV9Wxgf2BZkoOA44FzqmoJcE57TpJ9gOXAvsAy4KQk89q6Pg6sBJa0adnW2xVJ0nSmDf0a3NWebt+mAg4HVrfy1cCr2/zhwGlVdW9VXQOsAw5MsgewU1WdX1UFnDrSRpI0BjMa008yL8klwM3A2VX1fWD3qroBoD3u1qovAK4bab6hlS1o8xPLJUljMqPQr6r7q2p/YCHDWft+U1SfbJy+pih/4AqSlUnWJlm7cePGmXRRkjQDW3T3TlXdDpzLMBZ/UxuyoT3e3KptABaNNFsIXN/KF05SPtl2Tq6qpVW1dP78+VvSRUnSFGZy9878JDu3+R2BlwFXAmcAK1q1FcDpbf4MYHmSHZLszXDB9oI2BHRnkoPaXTtHjbSRJI3BdjOoswewut2B8whgTVWdmeR8YE2SNwLXAkcAVNVlSdYAlwP3AcdW1f1tXccApwA7Al9vkyRpTKYN/ar6IfCcScpvBQ7eTJtVwKpJytcCU10PkCRtQ34jV5I6YuhLUkcMfUnqiKEvSR0x9CWpI4a+JHXE0Jekjhj6ktQRQ1+SOmLoS1JHDH1J6oihL0kdMfQlqSOGviR1xNCXpI4Y+pLUEUNfkjpi6EtSRwx9SeqIoS9JHTH0Jakjhr4kdcTQl6SOGPqS1BFDX5I6YuhLUkcMfUnqiKEvSR0x9CWpI4a+JHXE0Jekjkwb+kkWJfnnJFckuSzJca18lyRnJ7m6PT5+pM0JSdYluSrJISPlByS5tC37WJJsm92SJE1mJmf69wHvqKpnAgcBxybZBzgeOKeqlgDntOe0ZcuBfYFlwElJ5rV1fRxYCSxp07KtuC+SpGlMG/pVdUNVXdzm7wSuABYAhwOrW7XVwKvb/OHAaVV1b1VdA6wDDkyyB7BTVZ1fVQWcOtJGkjQGWzSmn2Qx8Bzg+8DuVXUDDG8MwG6t2gLgupFmG1rZgjY/sVySNCYzDv0kjwG+Ary1qu6YquokZTVF+WTbWplkbZK1GzdunGkXJUnTmFHoJ9meIfD/T1X931Z8UxuyoT3e3Mo3AItGmi8Erm/lCycpf4CqOrmqllbV0vnz5890XyRJ05jJ3TsBPg1cUVUfHll0BrCiza8ATh8pX55khyR7M1ywvaANAd2Z5KC2zqNG2kiSxmC7GdR5EXAkcGmSS1rZe4ATgTVJ3ghcCxwBUFWXJVkDXM5w58+xVXV/a3cMcAqwI/D1NkmSxmTa0K+q85h8PB7g4M20WQWsmqR8LbDflnRQkrT1+I1cSeqIoS9JHTH0Jakjhr4kdcTQl6SOGPqS1BFDX5I6YuhLUkcMfUnqiKEvSR0x9CWpI4a+JHXE0Jekjhj6ktQRQ1+SOmLoS1JHDH1J6oihL0kdMfQlqSOGviR1xNCXpI4Y+pLUEUNfkjpi6EtSRwx9SeqIoS9JHTH0Jakjhr4kdcTQl6SOGPqS1BFDX5I6Mm3oJ/lMkpuT/GikbJckZye5uj0+fmTZCUnWJbkqySEj5QckubQt+1iSbP3dkSRNZSZn+qcAyyaUHQ+cU1VLgHPac5LsAywH9m1tTkoyr7X5OLASWNKmieuUJG1j04Z+VX0b+PmE4sOB1W1+NfDqkfLTqureqroGWAccmGQPYKeqOr+qCjh1pI0kaUwe7Jj+7lV1A0B73K2VLwCuG6m3oZUtaPMTyyVJY7S1L+RONk5fU5RPvpJkZZK1SdZu3Lhxq3VOknr3YEP/pjZkQ3u8uZVvABaN1FsIXN/KF05SPqmqOrmqllbV0vnz5z/ILkqSJnqwoX8GsKLNrwBOHylfnmSHJHszXLC9oA0B3ZnkoHbXzlEjbSRJY7LddBWSfBF4MbBrkg3A+4ETgTVJ3ghcCxwBUFWXJVkDXA7cBxxbVfe3VR3DcCfQjsDX2yRJGqNpQ7+qXreZRQdvpv4qYNUk5WuB/baod9vI4uPPmu0uTGv9iYfOdhckPQz5jVxJ6oihL0kdMfQlqSPTjulL0lw1F67fwXiv4XmmL0kdMfQlqSOGviR1xNCXpI4Y+pLUEUNfkjpi6EtSRwx9SeqIoS9JHTH0Jakjhr4kdcTQl6SOGPqS1BFDX5I6YuhLUkcMfUnqiKEvSR0x9CWpI4a+JHXE0Jekjhj6ktSR7Wa7A5rbFh9/1mx3YUbWn3jobHdBekjwTF+SOmLoS1JHDH1J6oihL0kdMfQlqSOGviR1ZOyhn2RZkquSrEty/Li3L0k9G2voJ5kH/B3wSmAf4HVJ9hlnHySpZ+M+0z8QWFdVP6mqfwNOAw4fcx8kqVupqvFtLHkNsKyq3tSeHwk8v6r+YkK9lcDK9vTpwFVj6+SDtytwy2x34mHCY7l1eTy3rrlyPPeqqvkTC8f9MwyZpOwB7zpVdTJw8rbvztaTZG1VLZ3tfjwceCy3Lo/n1jXXj+e4h3c2AItGni8Erh9zHySpW+MO/QuBJUn2TvJIYDlwxpj7IEndGuvwTlXdl+QvgH8C5gGfqarLxtmHbWhODUc9xHksty6P59Y1p4/nWC/kSpJml9/IlaSOGPqS1BFDX5I6Yuhr1iV5RpKDkzxmQvmy2erTXJbkwCTPa/P7JHl7kj+e7X49HCQ5dbb78LvyQu5WluToqvrsbPdjrkjyFuBY4Apgf+C4qjq9Lbu4qp47i92bc5K8n+G3rbYDzgaeD5wLvAz4p6paNXu9m1uSTLydPMBLgG8CVNWrxt6prcDQ38qSXFtVT5rtfswVSS4FXlBVdyVZDHwZ+FxV/c8k/1pVz5ndHs4t7XjuD+wA3AgsrKo7kuwIfL+qfn82+zeXJLkYuBz4FMMvBwT4IsP3i6iqb81e7x68cf8Mw8NCkh9ubhGw+zj78jAwr6ruAqiq9UleDHw5yV5M/rMdmtp9VXU/cHeSH1fVHQBV9askv5nlvs01S4HjgPcC76yqS5L8aq6G/SaG/oOzO3AIcNuE8gDfG3935rQbk+xfVZcAtDP+w4DPAM+a1Z7NTf+W5NFVdTdwwKbCJI8DDP0tUFW/AT6S5Evt8SYeBpk553dglpwJPGZTUI1Kcu7YezO3HQXcN1pQVfcBRyX537PTpTntj6rqXvhtaG2yPbBidro0t1XVBuCIJIcCd8x2f35XjulLUke8ZVOSOmLoS1JHDH11K8kTk5yW5MdJLk/ytSRPS/KjrbiNU9pfjJtY/uIkZ26t7Ugz5YVcdSlJgK8Cq6tqeSvbH2+51cOcZ/rq1UuAX1fVJzYVtLuxrtv0PMniJN9JcnGbXtjK90jy7SSXJPlRkj9MMq+d1f8oyaVJ3jZxg0mWJbkyyXnAn277XZQeyDN99Wo/4KJp6twMvLyq7kmyhOHbmEuB19N+0iDJPODRDN+CXVBV+wEk2Xl0RUkeBXwSeCmwDvj7rbcr0sx5pi9t3vbAJ9tPG3wJ2KeVXwgcneQDwLOq6k7gJ8CTk/xt+6G4ifdzPwO4pqquruE+6c+PZQ+kCQx99eoyRr6xuhlvA24Cns1whv9IgKr6NvBHwM+AzyU5qqpua/XOZfgBuU9Nsj6/FKNZZ+irV98Edkjy5k0F7eeI9xqp8zjghvbN1iMZ/q4z7XeBbq6qTwKfBp6bZFfgEVX1FeB9wMRfB70S2DvJU9rz122DfZKm5Zi+ulRVleTfAx9NcjxwD7AeeOtItZOAryQ5Avhn4Jet/MXAO5P8GriL4ackFgCfTbLpROqECdu7J8lK4KwktwDnMVxXkMbKn2GQpI44vCNJHTH0Jakjhr4kdcTQl6SOGPqS1BFDX5I6YuhLUkcMfUnqyP8H6Nn2ljKbnScAAAAASUVORK5CYII=
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">counts</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s2">&quot;ImageId&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">hist_counts</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">counts</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">nums</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">nums</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">hist_counts</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Num of defects per images&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="p">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span> <span class="n">c</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">hist_counts</span><span class="p">)}</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{1: 6239, 2: 425, 3: 2}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Images have at least one defect and there's a small number of images with two or three defects.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Multiple defects:&quot;</span><span class="p">)</span>
<span class="n">imgs_class_agg</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;ImageId&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;ClassId&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

<span class="n">pairs</span> <span class="o">=</span> <span class="n">imgs_class_agg</span><span class="p">[</span><span class="n">imgs_class_agg</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">triples</span> <span class="o">=</span> <span class="n">imgs_class_agg</span><span class="p">[</span><span class="n">imgs_class_agg</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">pairs</span><span class="p">))</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">triples</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
    <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;ClassId </span><span class="si">{</span><span class="n">ids</span><span class="si">}</span><span class="s2"> counts </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2"> images&quot;</span> <span class="k">for</span> <span class="n">ids</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">most_common</span><span class="p">()]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
    <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;ClassId </span><span class="si">{</span><span class="n">ids</span><span class="si">}</span><span class="s2"> counts </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2"> images&quot;</span> <span class="k">for</span> <span class="n">ids</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">most_common</span><span class="p">()]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Multiple defects:
ClassId (3, 4) counts 284 images
ClassId (1, 3) counts 91 images
ClassId (1, 2) counts 35 images
ClassId (2, 3) counts 14 images
ClassId (2, 4) counts 1 images
ClassId (1, 2, 3) counts 2 images
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we can see below, in <a href="/steel_segmentation/metadata.html#train"><code>train</code></a> there're 7095 defects in 6666 images but there're 12568 images in <a href="/steel_segmentation/metadata.html#train_pfiles"><code>train_pfiles</code></a>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">unique_imgs</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)[</span><span class="s2">&quot;ImageId&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">unique_imgs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>count     7095
unique    6666
Name: ImageId, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">unique_imgs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">7095</span>
<span class="k">assert</span> <span class="n">unique_imgs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">6666</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="All-training-images">All training images<a class="anchor-link" href="#All-training-images"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_all</span> <span class="o">=</span> <span class="n">get_train_df</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In <a href="/steel_segmentation/metadata.html#train_all"><code>train_all</code></a> are stored all the training images in <a href="/steel_segmentation/metadata.html#train"><code>train</code></a> plus the hard negatives. The latter have:</p>
<ul>
<li><code>EncodedPixels</code>: with -1, </li>
<li><code>ClassId</code>: with 0 class,</li>
<li><code>status</code>: with "no_faulty" string</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Count imgs&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fontsize&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">})</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">tick_top</span><span class="p">()</span>  <span class="c1"># Display x-axis ticks on top</span>

<span class="p">(</span>
    <span class="n">train_all</span><span class="p">[[</span><span class="s1">&#39;ImageId&#39;</span><span class="p">,</span> <span class="s1">&#39;status&#39;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
    <span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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6dM/8TgTJ05k7ty51NXVMWHCBMaOHctdd93VeP+YMWO4++6722ROUnPmz59Pv379+Id/+Aeqq6s5+OCDef/995k9ezbDhg1jwIABHHPMMbz99tvNbn/PPfdwxRVX8Mtf/pIDDzwQgKOPPpohQ4ZQXV3Ndddd17juNtts03j7jjvuYNy4cZ94rDvuuIMZM2YwZswY6urq+NOf/sQxxxzTeP8DDzzAqFGjWnD27VxKqV19laaslvSlL30pvfnmm2n58uXpo48+Siml9MADD6RRo0allFK66aab0ve///3G9UeOHJmmTZv2iW3nzZuXqqurG9eZPn16Ouqoo1JKKS1btiz16dOn8bHVcnw9rL958+aljh07plmzZqWUUho9enS69dZbU21tbZo+fXpKKaVJkyalH/zgB+t8jAsuuCBddtlljX9/6623UkoprVy5MlVXV6elS5emlFLq1q1b4zq33357OvHEEz+1/YgRI9LTTz+dUkpp9erVaa+99kpLlixJKaV0/PHHp7vvvnvTJ92OFK+FZrvhHqVazPLlyxk9ejQ1NTWceeaZPP/88xv9WCNGjOC1115jyZIl/OY3v+HYY4+lU6f2eO6ZNie77rordXV1AAwZMoS5c+eybNkyRowYAcCJJ57Io48+ut6Pd+WVVzJw4ECGDRvGggULePXVVzdqXBHB2LFj+fWvf82yZct44okn+MY3vrFRj6VP8zuPWsykSZM48MADmTp1KvPnz+eAAw4AoFOnTqxevbpxvVWrVq3X440dO5YpU6Zw2223ceONN7bGkKUNsvXWWzfe7tixI8uWLdvox5o+fToPPvggTzzxBF27duWAAw5ofG00PQFzfV8vJ510EkcccQRdunRh9OjR/mDZgtyjVItZvnw5u+yyC1B6X3KNPn36MHv2bFavXs2CBQt46qmnPrXttttuy7vvvvuJZePGjeOKK64AoLq6utXGLW2s7t27s/322/PYY48BcOuttzbuXX6W5cuXs/3229O1a1deeuklnnzyycb7dtppJ1588UVWr17N1KlTm91+7ddMz5496dmzJxdddNGn3tPUpjGUajFnn3025557LsOHD+fjjz9uXD58+HB23XVXamtrOeussxg8ePCntt1hhx0YPnw4NTU1TJgwASh9s+jXrx8nnXRSm81B2lC33HILEyZMYMCAAcyePZvzzz9/vbY79NBDaWhoYMCAAUyaNIlhw4Y13nfJJZdw+OGH89WvfpWdd9652e3HjRvHKaecQl1dHe+//z5QOumtd+/e9O/ff9Mnpkbt7pfvIyK1tzlvqVauXEltbS319fV079693MOpSF5woLKcdtppDBo0iO9973vlHsoWp3gtNHvRAfcotVl68MEHqaqq4p//+Z+NpLQehgwZwpw5czjhhBPKPZSK06p7lJ/73Of+tmrVqp1a7Qk2QpcuXdb7zXGp0vl6kEq6dOmy+v333+/Y3H2tGsrN8TCnh5qk/+LrQSrZ7A+9XnHFFaxcubLF1pPKZdmyZRx33HFUVVXRr18/nnjiCQCuuuoq9tprL6qrqzn77LMb158zZw777rsv1dXV1NbWNu7dffjhh4wfP54999yTqqoqfve735VlPtKm6NOnD7W1tdTV1TF06FAAnnnmGfbdd19qa2s54ogjeOeddxrX/+lPf8ruu+/OXnvtxX333QeUzlUYOXIkVVVVVFdXM3HixLafyLquRNASX6znVT/WXJ2lpdbLWd8xSRvjO9/5Trr++utTSil98MEH6e23304PP/xwOuigg9KqVatSSiktXrw4pZTSRx99lGpra9Ps2bNTSiktXbo0NTQ0pJRSOv/889OPfvSjlFJKH3/88Sb/u18XXw9qTc19zx46dGjjlYxuuOGGdN5556WUUnr++efTgAED0qpVq9Lrr7+e+vbtmxoaGtKKFSvSww8/nFIqvaa+8pWvpHvuuafFx8rmdGWeFStWMHLkSAYOHEhNTQ0/+clPWLRoEQceeGDj9Q9PPfVUhg4dSnV1NRdccAFQuoLF2uut63qIt99+OzU1NQwcOJD999+/bSeoduudd97h0UcfbTzjsHPnzmy33XZcc801TJw4sfGX1b/whS8AcP/99zNgwAAGDhwIlH5FpmPH0lskN954I+eeey4AHTp0oEePHm09HalVvPzyy43fl7/+9a83Hi256667+Na3vsXWW2/Nrrvuyu67785TTz1F165dG7/nd+7cmcGDB7Nw4cI2HXObh/LPf/4zPXv25JlnnuG5557jjDPOoGfPnkybNo1p06YBcPHFFzNjxgzmzJnDI488wpw5czj99NM/td66XHjhhdx3330888wzXkhbbeb1119nxx135KSTTmLQoEGcfPLJrFixgldeeYXHHnuMffbZhxEjRvD0008D8MorrxARHHLIIQwePJif/exnAI1Xe5k0aRKDBw9m9OjRLF68uFzTkjZaRHDwwQczZMiQxou+19TUNH5fvv3221mwYAEAb7zxBr17927ctlevXrzxxhufeLxly5bxhz/8gYMOOqiNZlDS5qGsra3lwQcf5JxzzuGxxx5r9tT/3/72twwePJhBgwbx/PPP88ILL2zQcwwfPpxx48Zx/fXXf+IX36XW1NDQQH19PaeeeiqzZs2iW7duXHLJJTQ0NPD222/z5JNPctlll/HNb36TlBINDQ385S9/YcqUKfzlL39h6tSpPPTQQzQ0NLBw4UKGDx9OfX09++67L2eddVa5pydtsMcff5z6+nruvfdeJk+ezKOPPsqNN97I5MmTGTJkCO+++y6dO3cGaPaksqaX8mtoaOD444/n9NNPp2/fvm02ByhDKPfcc09mzpxJbW0t5557LhdeeOEn7p83bx6XX345Dz30EHPmzGHkyJHrPH19XddDvPbaa7noootYsGABdXV1vPXWW60zGamJXr160atXL/bZZx8AjjvuOOrr6+nVqxejRo0iIth7773p0KEDS5cupVevXowYMYIePXrQtWtXDjvsMOrr69lhhx3o2rVr48cmjR49mvr6+nJOTdooPXv2BEpvNxxzzDE89dRTVFVVcf/99zNz5kyOP/74xs/l7NWrV+PeJcDChQsbtwcYP348e+yxB2eccUabzgHKEMpFixbRtWtXTjjhBM466yzq6+s/cc3Cd955h27dutG9e3cWL17Mvffe27jt2tc2XNf1EOfOncs+++zDhRdeSI8ePT7xH19qLV/84hfp3bt34+dwPvTQQ/Tv35+jjz6ahx9+GCgdbv3www/p0aMHhxxyCHPmzGHlypU0NDTwyCOP0L9/fyKCI444ovEzO9c8jrQlWbFiReP36xUrVnD//fdTU1PDkiVLAFi9ejUXXXQRp5xyCgBHHnkkt912Gx988AHz5s3j1VdfZe+99wbgvPPOY/ny5Y3Xfm5rbX55+WeffZYJEybQoUMHttpqK6655prGj4TZeeedmTZtGoMGDaK6upq+ffsyfPjwxm3Hjx//ifXWXA+xd+/e1NTU8N577wEwYcIEXn31VVJKHHTQQY0nS0it7aqrrmLMmDF8+OGH9O3bl5tuuolu3brx3e9+l5qaGjp37swtt9xCRLD99tvzwx/+kC9/+ctEBIcddhgjR44E4NJLL2Xs2LGcccYZ7Ljjjtx0001lnpm0YRYvXtx4VKShoYFvf/vbHHroofz85z9n8uTJAIwaNarxWs7V1dV885vfpH///nTq1InJkyfTsWNHFi5cyMUXX0xVVVXjdaJPO+00Tj755DabixcckNoxXw9SyWZ/wQFJkjZXrXrotUuXLosjYnO71uvqiPAHBAlfD9IaXbp0WefvYLW7j9mSJGlD+JOkJEkZhlKSpAxDKUlShqGUJCnDUEqSlPH/AdgyM0/tRr+LAAAAAElFTkSuQmCC
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_all</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>ImageId              object
ClassId               int64
EncodedPixels        object
ImageId_ClassId      object
status             category
dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_all</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)[:</span><span class="mi">4</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ImageId</th>
      <th>ClassId</th>
      <th>EncodedPixels</th>
      <th>ImageId_ClassId</th>
      <th>status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>12997</td>
      <td>12997.0</td>
      <td>12997.0</td>
      <td>7095</td>
      <td>12997</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>12568</td>
      <td>NaN</td>
      <td>7096.0</td>
      <td>7095</td>
      <td>2</td>
    </tr>
    <tr>
      <th>top</th>
      <td>db4867ee8.jpg</td>
      <td>NaN</td>
      <td>-1.0</td>
      <td>c0ceecd96.jpg_3</td>
      <td>faulty</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>3</td>
      <td>NaN</td>
      <td>5902.0</td>
      <td>1</td>
      <td>7095</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">count_pct</span><span class="p">(</span><span class="n">train_all</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>num</th>
      <th>freq</th>
    </tr>
    <tr>
      <th>ClassId</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5902</td>
      <td>0.454105</td>
    </tr>
    <tr>
      <th>1</th>
      <td>897</td>
      <td>0.069016</td>
    </tr>
    <tr>
      <th>2</th>
      <td>247</td>
      <td>0.019004</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5150</td>
      <td>0.396245</td>
    </tr>
    <tr>
      <th>4</th>
      <td>801</td>
      <td>0.061630</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Train-transforms">Train transforms<a class="anchor-link" href="#Train-transforms"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Loading the images for models requires some transformations to the <a href="/steel_segmentation/metadata.html#train"><code>train</code></a> or <a href="/steel_segmentation/metadata.html#train_all"><code>train_all</code></a> DataFrames.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Pivot-RLE-encodings">Pivot RLE encodings<a class="anchor-link" href="#Pivot-RLE-encodings"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_train_pivot" class="doc_header"><code>get_train_pivot</code><a href="https://github.com/marcomatteo/steel_segmentation/tree/master/steel_segmentation/metadata.py#L71" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_train_pivot</code>()</p>
</blockquote>
<p>Summarize the training csv with ClassId as columns and values EncodedPixels</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <a href="/steel_segmentation/metadata.html#get_train_pivot"><code>get_train_pivot</code></a> is the pivoted version of <a href="/steel_segmentation/metadata.html#train_all"><code>train_all</code></a>. All the images are in the index, for each image the <code>ClassId</code> encoding values are in the columns.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_pivot</span> <span class="o">=</span> <span class="n">get_train_pivot</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_pivot</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>ClassId</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>n</th>
    </tr>
    <tr>
      <th>ImageId</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0002cc93b.jpg</th>
      <td>NaN</td>
      <td>29102 12 29346 24 29602 24 29858 24 30114 24 30370 24 30626 24 30882 24 31139 23 31395 23 31651 23 31907 23 32163 23 32419 23 32675 23 77918 27 78174 55 78429 60 78685 64 78941 68 79197 72 79452 77 79708 81 79964 85 80220 89 80475 94 80731 98 80987 102 81242 105 81498 105 81754 104 82010 104 82265 105 82521 31 82556 69 82779 27 82818 63 83038 22 83080 57 83297 17 83342 50 83555 13 83604 44 83814 8 83866 37 84073 3 84128 31 84390 25 84652 18 84918 8 85239 10 85476 29 85714 47 85960 57 86216 57 86471 58 86727 58 86983 58 87238 59 87494 59 87750 59 88005 60 88261 60 88517 60 88772 61 89028 53...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
    <tr>
      <th>00031f466.jpg</th>
      <td>-1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">count_pct</span><span class="p">(</span><span class="n">train_pivot</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>num</th>
      <th>freq</th>
    </tr>
    <tr>
      <th>n</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>12141</td>
      <td>0.966025</td>
    </tr>
    <tr>
      <th>2</th>
      <td>425</td>
      <td>0.033816</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>0.000159</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Multi-class-defects">Multi class defects<a class="anchor-link" href="#Multi-class-defects"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_classification_df" class="doc_header"><code>get_classification_df</code><a href="https://github.com/marcomatteo/steel_segmentation/tree/master/steel_segmentation/metadata.py#L84" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_classification_df</code>(<strong><code>df</code></strong>:<code>DataFrame</code>=<em><code>None</code></em>)</p>
</blockquote>
<p>Get the DataFrame for the multiclass classification model</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <a href="/steel_segmentation/metadata.html#get_classification_df"><code>get_classification_df</code></a> allows to build a DataFrame to classification models. In <code>ClassId_multi</code> are listed the <code>ClassId</code>s separated by a space.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_multi</span> <span class="o">=</span> <span class="n">get_classification_df</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_multi</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>ClassId</th>
      <th>ImageId</th>
      <th>ClassId_multi</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0002cc93b.jpg</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>00031f466.jpg</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>000418bfc.jpg</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>000789191.jpg</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0007a71bf.jpg</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">count_pct</span><span class="p">(</span><span class="n">train_multi</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;ClassId_multi&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;freq&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>num</th>
      <th>freq</th>
    </tr>
    <tr>
      <th>ClassId_multi</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5902</td>
      <td>0.469605</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4759</td>
      <td>0.378660</td>
    </tr>
    <tr>
      <th>1</th>
      <td>769</td>
      <td>0.061187</td>
    </tr>
    <tr>
      <th>4</th>
      <td>516</td>
      <td>0.041057</td>
    </tr>
    <tr>
      <th>3 4</th>
      <td>284</td>
      <td>0.022597</td>
    </tr>
    <tr>
      <th>2</th>
      <td>195</td>
      <td>0.015516</td>
    </tr>
    <tr>
      <th>1 3</th>
      <td>91</td>
      <td>0.007241</td>
    </tr>
    <tr>
      <th>1 2</th>
      <td>35</td>
      <td>0.002785</td>
    </tr>
    <tr>
      <th>2 3</th>
      <td>14</td>
      <td>0.001114</td>
    </tr>
    <tr>
      <th>1 2 3</th>
      <td>2</td>
      <td>0.000159</td>
    </tr>
    <tr>
      <th>2 4</th>
      <td>1</td>
      <td>0.000080</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_multi</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>ClassId</th>
      <th>ImageId</th>
      <th>ClassId_multi</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>12568</td>
      <td>12568</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>12568</td>
      <td>11</td>
    </tr>
    <tr>
      <th>top</th>
      <td>79c106c42.jpg</td>
      <td>0</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>1</td>
      <td>5902</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Test-data">Test data<a class="anchor-link" href="#Test-data"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_pfiles</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#5506) [Path(&#39;../data/test_images/2b6c68337.jpg&#39;),Path(&#39;../data/test_images/73ff8efef.jpg&#39;),Path(&#39;../data/test_images/1e45cda5b.jpg&#39;),Path(&#39;../data/test_images/549fb29f7.jpg&#39;),Path(&#39;../data/test_images/5f0696eb5.jpg&#39;),Path(&#39;../data/test_images/f9462ebef.jpg&#39;),Path(&#39;../data/test_images/28fdc7d3d.jpg&#39;),Path(&#39;../data/test_images/0adb09acc.jpg&#39;),Path(&#39;../data/test_images/e0d6b15d3.jpg&#39;),Path(&#39;../data/test_images/e80c9a5a5.jpg&#39;)...]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s1">&#39;sample_submission.csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ImageId</th>
      <th>EncodedPixels</th>
      <th>ClassId</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0000f269f.jpg</td>
      <td>1 409600</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>000ccc2ac.jpg</td>
      <td>1 409600</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>002451917.jpg</td>
      <td>1 409600</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>003c5da97.jpg</td>
      <td>1 409600</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0042e163f.jpg</td>
      <td>1 409600</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">test_df</span><span class="o">.</span><span class="n">shape</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="mi">5506</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

