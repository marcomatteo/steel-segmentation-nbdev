---

title: Predict


keywords: fastai
sidebar: home_sidebar

summary: "Prediction and export outputs."
description: "Prediction and export outputs."
nb_path: "nbs/07_model.predict.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/07_model.predict.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this notebook the <em>functions</em> provided can be used to make inference with the models trained and saved in <a href="/steel_segmentation/models.model.html#models_dir"><code>models_dir</code></a>.</p>
<p>The first section is related to the fast.ai API while the second is for a general Pytorch approach.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_competition_data</span><span class="p">(</span><span class="n">models_dir</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>../models/ResNet18-Unet-kaggle.pth
../models/.ipynb_checkpoints
../models/ResNet18-Classifier-kaggle.pth
../models/ResNet34-Unet-256-stage5.pth
../models/ResNet34-Unet-256-stage3.pth
../models/ResNet34-Unet-128-stage2.5.pth
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Fast.ai-prediction">Fast.ai prediction<a class="anchor-link" href="#Fast.ai-prediction"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First, we need to load a <code>segmentation_learner</code> with the right <code>parameters</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">arch</span> <span class="o">=</span> <span class="n">resnet34</span>
<span class="n">bs</span> <span class="o">=</span> <span class="mi">4</span> 
<span class="n">dls</span> <span class="o">=</span> <span class="n">get_segmentation_dls_from_df</span><span class="p">(</span><span class="n">train_df</span><span class="o">=</span><span class="n">train_multi</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="n">bs</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">1600</span><span class="p">))</span>
<span class="n">segmentation_learner</span> <span class="o">=</span> <span class="n">unet_learner</span><span class="p">(</span><span class="n">dls</span><span class="o">=</span><span class="n">dls</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="n">arch</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">seg_metrics</span><span class="p">,</span> <span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">segmentation_learner</span><span class="o">.</span><span class="n">model_dir</span> <span class="o">=</span> <span class="n">models_dir</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">segmentation_learner</span> <span class="o">=</span> <span class="n">segmentation_learner</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;ResNet34-Unet-256-stage5&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Predict" class="doc_header"><code>class</code> <code>Predict</code><a href="https://github.com/marcomatteo/steel_segmentation/tree/master/steel_segmentation/models/predict.py#L34" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Predict</code>(<strong><code>source</code></strong>, <strong><code>learner</code></strong>, <strong><code>source_path</code></strong>:<code>Path</code>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <a href="/steel_segmentation/model.predict.html#Predict"><code>Predict</code></a> class needs a <code>source</code>, as a list of images to infer, and a fast.ai <code>Learner</code>. The inference can be done on:</p>
<ul>
<li>a single image with the <code>ImageId</code> as string</li>
<li>a list (<code>L</code>) of images paths</li>
<li>a dataframe with the <code>ImageId</code> column.</li>
</ul>
<p>The class needs a initialization first to setup the <code>source</code>. The object is now callable to get the predictions <code>DataFrame</code> with the <code>ImageId_ClassId</code> and the <code>EncodedPixels</code> columns.</p>
<p>To get the predictions:</p>
<ol>
<li>Setup the <a href="/steel_segmentation/model.predict.html#Predict"><code>Predict</code></a> class</li>
<li>Call the object (e.g. <code>pred</code>) with the parameters: <code>size_fold</code> is the number of elements to infer toghether, <code>threshold</code> is the threshold for the probabilities from the activation function, <code>min_size</code> needs to ignore components in the predicted masks with few number of pixels (to reduce the false positive rate).</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>An example of <code>pd.DataFrame</code> source:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_tmp</span> <span class="o">=</span> <span class="n">segmentation_learner</span><span class="o">.</span><span class="n">dls</span><span class="o">.</span><span class="n">valid</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
<span class="n">df_tmp</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(5, 2)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pred</span> <span class="o">=</span> <span class="n">Predict</span><span class="p">(</span><span class="n">df_tmp</span><span class="p">,</span> <span class="n">segmentation_learner</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Predict.__call__" class="doc_header"><code>Predict.__call__</code><a href="https://github.com/marcomatteo/steel_segmentation/tree/master/steel_segmentation/models/predict.py#L197" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Predict.__call__</code>(<strong><code>size_fold</code></strong>:<code>int</code>, <strong><code>threshold</code></strong>:<code>float</code>, <strong><code>min_size</code></strong>:<code>int</code>)</p>
</blockquote>
<p>Call the object with prediction attributes,
it calls <a href="/steel_segmentation/model.predict.html#Predict.get_predictions"><code>Predict.get_predictions</code></a>
and returns the <a href="/steel_segmentation/model.predict.html#Predict.df"><code>Predict.df</code></a> DataFrame with RLEs.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">size_fold</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">min_size</span> <span class="o">=</span> <span class="mi">3000</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_pred</span> <span class="o">=</span> <span class="n">pred</span><span class="p">(</span><span class="n">size_fold</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">min_size</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df_pred</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>From 0 to 5 of 5
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(20, 2)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ImageId_ClassId</th>
      <th>EncodedPixels</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>b5352d213.jpg_1</td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>b5352d213.jpg_2</td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>b5352d213.jpg_3</td>
      <td>219065 4 219317 11 219572 13 219828 13 220083 14 220338 17 220594 17 220849 18 221104 20 221360 20 221616 21 221871 22 222126 23 222382 24 222638 24 222893 25 223149 25 223405 26 223661 26 223916 27 224172 27 224427 28 224683 28 224938 29 225194 29 225450 29 225706 29 225961 30 226217 30 226473 30 226729 30 226985 29 227240 30 227496 30 227752 30 228007 31 228263 31 228519 30 228774 31 229030 31 229286 31 229542 30 229798 30 230054 30 230310 29 230566 29 230821 30 231077 29 231333 29 231589 28 231845 28 232101 28 232357 28 232613 27 232870 26 233126 25 233382 25 233638 25 233894 25 234149 ...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>b5352d213.jpg_4</td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>ecb50399d.jpg_1</td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A <code>DataFrame</code> can have only one element too.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_tmp</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_tmp</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">pred</span> <span class="o">=</span> <span class="n">Predict</span><span class="p">(</span><span class="n">df_tmp</span><span class="p">,</span> <span class="n">segmentation_learner</span><span class="p">)</span>

<span class="n">df_pred</span> <span class="o">=</span> <span class="n">pred</span><span class="p">(</span><span class="n">size_fold</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">min_size</span><span class="p">)</span>
<span class="n">df_pred</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(1, 4)
From 0 to 1 of 1
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ImageId_ClassId</th>
      <th>EncodedPixels</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0002cc93b.jpg_1</td>
      <td>77411 11 77665 17 77918 20 78172 24 78427 26 78681 31 78937 30 79194 32 79229 1 79231 7 79239 1 79241 1 79271 1 79273 1 79275 1 79277 1 79279 1 79281 1 79283 1 79449 33 79485 1 79487 1 79489 9 79499 1 79519 1 79521 1 79523 1 79525 1 79527 1 79529 13 79543 1 79705 53 79759 1 79771 1 79773 31 79962 31 79996 1 79999 14 80015 1 80019 1 80021 1 80023 1 80025 35 80218 31 80255 3 80259 11 80271 48 80474 31 80513 13 80527 1 80529 1 80531 1 80533 43 80730 32 80767 67 80987 30 81024 1 81027 2 81030 3 81034 1 81036 1 81040 1 81043 46 81243 30 81279 15 81295 2 81299 47 81499 29 81538 1 81540 1 81542 1...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0002cc93b.jpg_2</td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>0002cc93b.jpg_3</td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>0002cc93b.jpg_4</td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Or to predict a single image mask with the file name:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span> <span class="o">=</span> <span class="s2">&quot;f383950e8.jpg&quot;</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">Predict</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">segmentation_learner</span><span class="p">)</span>
<span class="n">df_pred</span> <span class="o">=</span> <span class="n">pred</span><span class="p">(</span><span class="n">size_fold</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">min_size</span><span class="p">)</span>
<span class="n">df_pred</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>From 0 to 1 of 1
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ImageId_ClassId</th>
      <th>EncodedPixels</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>f383950e8.jpg_1</td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>f383950e8.jpg_2</td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>f383950e8.jpg_3</td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>f383950e8.jpg_4</td>
      <td>314087 26 314342 27 314590 35 314846 35 315088 1 315090 47 315344 49 315586 63 315841 64 316088 73 316345 72 316599 74 316855 74 317110 75 317365 76 317615 82 317870 83 318119 90 318374 91 318624 97 318878 1 318880 97 319118 1 319120 113 319374 115 319622 123 319877 124 320129 128 320385 128 320637 132 320893 132 321146 135 321400 137 321652 141 321908 141 322159 146 322415 146 322666 151 322922 151 323171 158 323426 159 323678 163 323932 165 324183 170 324438 171 324691 174 324947 174 325199 178 325454 179 325707 182 325962 183 326215 186 326470 187 326722 191 326974 1 326976 193 327222 1...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Predict.make_masks" class="doc_header"><code>Predict.make_masks</code><a href="https://github.com/marcomatteo/steel_segmentation/tree/master/steel_segmentation/models/predict.py#L138" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Predict.make_masks</code>()</p>
</blockquote>
<p>Iterate through the RLEs in <a href="/steel_segmentation/model.predict.html#Predict.df"><code>Predict.df</code></a> and save the masks.
Returns the <a href="/steel_segmentation/model.predict.html#Predict.df_masks"><code>Predict.df_masks</code></a> DataFrame (if not <code>json</code>) with
<code>columns=['ImageId', 'ClassId', 'Mask_path']</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pred</span><span class="o">.</span><span class="n">make_masks</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ImageId</th>
      <th>ClassId</th>
      <th>Mask_path</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>b5352d213.jpg</td>
      <td>3</td>
      <td>b5352d213_pred.png</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ecb50399d.jpg</td>
      <td>4</td>
      <td>ecb50399d_pred.png</td>
    </tr>
    <tr>
      <th>2</th>
      <td>39e365d3b.jpg</td>
      <td>3</td>
      <td>39e365d3b_pred.png</td>
    </tr>
    <tr>
      <th>3</th>
      <td>06e6582af.jpg</td>
      <td>3</td>
      <td>06e6582af_pred.png</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Predict.save_masks" class="doc_header"><code>Predict.save_masks</code><a href="https://github.com/marcomatteo/steel_segmentation/tree/master/steel_segmentation/models/predict.py#L160" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Predict.save_masks</code>(<strong><code>df_export_fname</code></strong>=<em><code>None</code></em>, <strong><code>make_zip</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>If <code>df_export_fname</code> save predicted masks in
<code>pred_path / df_export_fname</code> in CSV and the JSON.
Otherwise the file are named "predictions.csv" and "predictions.json".
Saving the zip of the masks if <code>make_zip</code>.</p>
<p>Run this method after <strong>call</strong> the object.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pred</span><span class="o">.</span><span class="n">save_masks</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pred_path</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#8) [Path(&#39;../data/predictions/validation_masks.json&#39;),Path(&#39;../data/predictions/validation_masks.zip&#39;),Path(&#39;../data/predictions/predictions.csv&#39;),Path(&#39;../data/predictions/.ipynb_checkpoints&#39;),Path(&#39;../data/predictions/validation_masks.csv&#39;),Path(&#39;../data/predictions/predictions.zip&#39;),Path(&#39;../data/predictions/predictions.json&#39;),Path(&#39;../data/predictions/prediction_masks&#39;)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Predict.save_submission" class="doc_header"><code>Predict.save_submission</code><a href="https://github.com/marcomatteo/steel_segmentation/tree/master/steel_segmentation/models/predict.py#L188" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Predict.save_submission</code>(<strong><code>fname</code></strong>=<em><code>'test_submission'</code></em>)</p>
</blockquote>
<p>Save submission file in CSV in <a href="/steel_segmentation/model.predict.html#sub_path"><code>sub_path</code></a>.
It adds always .csv at the end of <code>fname</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pred</span><span class="o">.</span><span class="n">save_submission</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp_path</span> <span class="o">=</span> <span class="n">sub_path</span><span class="o">/</span><span class="s2">&quot;test_submission.csv&quot;</span>
<span class="k">assert</span> <span class="n">tmp_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To visualize predicted defects:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Predict.plot" class="doc_header"><code>Predict.plot</code><a href="https://github.com/marcomatteo/steel_segmentation/tree/master/steel_segmentation/models/predict.py#L212" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Predict.plot</code>(<strong><code>n</code></strong>:<code>int</code>=<em><code>5</code></em>, <strong><code>rand</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Plot <code>n</code> elements in <code>self.img_paths</code>.
If <code>rand</code> prints shuffle images.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pred</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rand</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;Nothing to plot, first call make_masks&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Pytorch-prediction">Pytorch prediction<a class="anchor-link" href="#Pytorch-prediction"> </a></h2>
</div>
</div>
</div>
</div>
 

